import json
import time

def classify_drift_direction(agentA, agentB, score, history_sample):
    # Simple heuristic: compare current score to history
    avg_history = sum(history_sample) / len(history_sample)
    delta = score - avg_history

    if delta > 0.1:
        direction = "divergent"
    elif delta < -0.1:
        direction = "convergent"
    else:
        direction = "stable"

    log_entry = {
        "timestamp": time.time(),
        "agentA": agentA,
        "agentB": agentB,
        "score": score,
        "avg_history": avg_history,
        "delta": delta,
        "direction": direction
    }

    with open("Drift_Direction_Log.jsonl", "a") as f:
        f.write(json.dumps(log_entry) + "\n")

    return direction
{"timestamp": 1755732017.7675138, "agentA": "A335", "agentB": "B335", "score": 0.33620584, "avg_history": 0.33620584, "delta": 0.0, "direction": "stable"}
{"timestamp": 1755735643.2254503, "agentA": "alpha", "agentB": "beta", "score": 0.5, "avg_history": 0.5, "delta": 0.0, "direction": "stable"}
{"timestamp": 1755735643.227184, "agentA": "beta", "agentB": "gamma", "score": 0.85, "avg_history": 0.8500000000000001, "delta": -1.1102230246251565e-16, "direction": "stable"}
{"timestamp": 1755735643.2299197, "agentA": "gamma", "agentB": "delta", "score": 0.25, "avg_history": 0.25, "delta": 0.0, "direction": "stable"}
{"timestamp": 1755921701.9772224, "agentA": "A335", "agentB": "B335", "score": 0.0, "avg_history": 0.33620584, "delta": -0.33620584, "direction": "convergent"}
{"timestamp": 1755921701.9789639, "agentA": "A335", "agentB": "C335", "score": 0.0, "avg_history": 0.33620584, "delta": -0.33620584, "direction": "convergent"}
{"timestamp": 1755921701.9826887, "agentA": "B335", "agentB": "C335", "score": 0.0, "avg_history": 0.33620584, "delta": -0.33620584, "direction": "convergent"}
{"timestamp": 1755922010.159937, "agentA": "A335", "agentB": "B335", "score": 0.0, "avg_history": 0.33620584, "delta": -0.33620584, "direction": "convergent"}
{"timestamp": 1755922010.1649976, "agentA": "A335", "agentB": "C335", "score": 0.0, "avg_history": 0.33620584, "delta": -0.33620584, "direction": "convergent"}
{"timestamp": 1755922010.1671228, "agentA": "B335", "agentB": "C335", "score": 0.0, "avg_history": 0.33620584, "delta": -0.33620584, "direction": "convergent"}
{"timestamp": 1755922144.8274572, "agentA": "A335", "agentB": "B335", "score": 0.5, "avg_history": 0.33620584, "delta": 0.16379416000000002, "direction": "divergent"}
{"timestamp": 1755922144.8326993, "agentA": "A335", "agentB": "C335", "score": 0.0, "avg_history": 0.33620584, "delta": -0.33620584, "direction": "convergent"}
{"timestamp": 1755922144.8347912, "agentA": "B335", "agentB": "C335", "score": 0.5, "avg_history": 0.33620584, "delta": 0.16379416000000002, "direction": "divergent"}
{"timestamp": 1755922505.1318018, "agentA": "A335", "agentB": "B335", "score": 0.5, "avg_history": 0.33620584, "delta": 0.16379416000000002, "direction": "divergent"}
{"timestamp": 1755922505.136966, "agentA": "A335", "agentB": "C335", "score": 0.0, "avg_history": 0.33620584, "delta": -0.33620584, "direction": "convergent"}
{"timestamp": 1755922505.1384041, "agentA": "B335", "agentB": "C335", "score": 0.5, "avg_history": 0.33620584, "delta": 0.16379416000000002, "direction": "divergent"}
{"timestamp": 1755922585.2947028, "agentA": "A335", "agentB": "B335", "score": 0.5, "avg_history": 0.33620584, "delta": 0.16379416000000002, "direction": "divergent"}
{"timestamp": 1755922585.2998807, "agentA": "A335", "agentB": "C335", "score": 0.0, "avg_history": 0.33620584, "delta": -0.33620584, "direction": "convergent"}
{"timestamp": 1755922585.3019578, "agentA": "B335", "agentB": "C335", "score": 0.5, "avg_history": 0.33620584, "delta": 0.16379416000000002, "direction": "divergent"}
